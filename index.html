<!DOCTYPE html>
<html lang="en">
<head>
	<title>Project 3</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<!--===============================================================================================-->
	<link rel="icon" type="image/png" href="images/icons/favicon.ico"/>
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/Linearicons-Free-v1.0.0/icon-font.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/iconic/css/material-design-iconic-font.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="css/util.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
<!--===============================================================================================-->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
crossorigin=""></script>

<script src='https://api.mapbox.com/mapbox-gl-js/v1.8.1/mapbox-gl.js'></script>
<link href='https://api.mapbox.com/mapbox-gl-js/v1.8.1/mapbox-gl.css' rel='stylesheet' />
</head>
<body>

	<div class="container-contact100">
		<div class="contact100-map" id="mapid" ></div>

		<div class="wrap-contact100">
			<form class="contact100-form validate-form">
				<span class="contact100-form-title">
					Location Service - TDD
				</span>

				<div class="wrap-input100 validate-input" id="lat" data-validate="Latitude is required (decimal)">
					<span class="label-input100">Latitude</span>
					<input class="input100" type="number" name="lat" step="any" min="-90" max="90" placeholder="Enter Latitude here...">
					<span class="focus-input100"></span>
				</div>

				<div class="wrap-input100 validate-input" id="long" data-validate = "Longitude is required (decimal)">
					<span class="label-input100">Longitude</span>
					<input class="input100" type="number" name="long" step="any" min="-180" max="180" placeholder="Enter Longitude here...">
					<span class="focus-input100"></span>
				</div>

				<div class="special-btn" id="get-gps-btn">
					<div class="wrap-contact100-form-btn">
						<div class="contact100-form-special"></div>
						<!-- <button class="contact100-form-btn" onclick="getCurrentPosition()">
							Get my Location using GPS
						</button> -->
						<!-- <button type="button" onclick="showPosition();">Get my Location using GPS</button> -->
						<button type="button" class="pure-button pure-button-primary" onclick="showPosition();">
							Get my location using GPS</button>
					</div>
				</div>

				<div class="special-btn" id="get-coords-btn">
					<div class="wrap-contact100-form-btn">
						<div class="contact100-form-special"></div>
						<button type="button" class="show-location-btn" onclick="showPositionbyCoordinates();">
							Get my location using Coordinates Above</button>
					</div>
				</div>

				<div class="container-contact100-form-btn" id="city-center-btn">
					<div class="wrap-contact100-form-btn">
						<div class="contact100-form-bgbtn"></div>
						<button type="button" class="contact100-form-btn" onclick="distanceToCityCenter();">
							Find distance from city center
						</button>
					</div>
				</div>

				<div class="container-contact100-form-btn" id="earth-center-btn">
					<div class="wrap-contact100-form-btn">
						<div class="contact100-form-bgbtn"></div>
						<button type="button" class="contact100-form-btn" onclick="distanceToEarthCenter();">
							Find distance from Earth center
						</button>
					</div>
				</div>
			</form>
			<div id="result">
			 <!--Position information will be inserted here-->
	 		</div>
		</div>
	</div>

	<!-- <script>
			function findCity() {
						var lat = document.getElementsByName("lat")[0].value;
						var long = document.getElementsByName("long")[0].value;
						var settings = {
								"async": true,
								"crossDomain": true,
								"url": "https://us1.locationiq.com/v1/reverse.php?key=8c71ca88032017&lat=-37.870662&lon=144.9803321&format=json",
								"method": "GET"
							}

				$.ajax(settings).done(function (response) {
					alert(response);
					//console.log(response);
				});
			}
	</script> -->

	<script>

			var latitude = 39.881951;
			var longitude = 32.758416;
			var mymap = L.map('mapid').setView([latitude, longitude], 12);

			L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={access_token}', {
				maxZoom: 18,
				attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
					'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
					'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
				id: 'mapbox/streets-v11',
				tileSize: 512,
				zoomOffset: -1,
				access_token: 'pk.eyJ1IjoiaGkxNCIsImEiOiJjazl4bTNrbmIwMmZ0M251c2psbTBkazU2In0.Xb2Rpdxp7u-XPRinPyf_tw'
			}).addTo(mymap);

			L.marker([latitude, longitude]).addTo(mymap)
				.bindPopup("<b>Hello!</b><br />This is Default location.").openPopup();

			L.circle([39.881951, 32.758416], 200, {
				color: 'red',
				fillColor: '#f03',
				fillOpacity: 0.5
			}).addTo(mymap).bindPopup("City center here.");

			// L.polygon([
			// 	[51.509, -0.08],
			// 	[51.503, -0.06],
			// 	[51.51, -0.047]
			// ]).addTo(mymap).bindPopup("I am a polygon.");

			var popup = L.popup();

			function onMapClick(e) {
				popup
					.setLatLng(e.latlng)
					.setContent("You clicked the map at " + e.latlng.toString())
					.openOn(mymap);
			}
			mymap.on('click', onMapClick);

			function showPosition() {
				mymap.locate({setView: true, maxZoom: 15});
			}

			mymap.on('locationfound', onLocationFound);
		  function onLocationFound(e) {
		    console.log(e);
		    L.marker(e.latlng).addTo(mymap)
		        .bindPopup("<b>Hello!</b><br />This is your location.").openPopup();;
		  }

			function showPositionbyCoordinates() {
				var lat = document.getElementsByName("lat")[0].value;
		 		var long = document.getElementsByName("long")[0].value;

		 		L.marker([lat, long]).addTo(mymap)
			 		.bindPopup("<b>Hello!</b><br />This is your location.").openPopup();
				mymap.setView([lat, long], 12);
			}


			function distanceToCityCenter() {
			  var lat1 = document.getElementsByName('lat')[0].value;
			  var long1 = document.getElementsByName("long")[0].value;
			  var lat2 = 41.326873;
			  var long2 = 19.818791;

				var dLat = deg2rad(lat2-lat1);  // deg2rad below
			  var dLon = deg2rad(long2-long1);
			  var a =
			    Math.sin(dLat/2) * Math.sin(dLat/2) +
			    Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *
			    Math.sin(dLon/2) * Math.sin(dLon/2)
			    ;
			  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
			  var d = 6367 * c; // Distance in km
			  //return d;
			  // const fi1 = lat1 * Math.PI/180, fi2 = lat2 * Math.PI/180, delta_lambda = (long2-long1) * Math.PI/180, R = 6371e3;
			  // const d = Math.acos( Math.sin(fi1)*Math.sin(fi2) + Math.cos(fi1)*Math.cos(fi2) * Math.cos(delta_lambda) ) * R;

				var info = "Your distance from City center is " + d + " km.";
				document.getElementById("result").innerHTML = info;

			  //return d;
			}

			function distanceToEarthCenter() {
			  var lat1 = document.getElementsByName('lat')[0].value;
			  var long1 = document.getElementsByName("long")[0].value;
			  var lat2 = 41.326873;
			  var long2 = 19.818791;

				var radius = 6370;
				var altitude = ' +/- 0.7';

				var info = "Your distance from Earth Center is " + radius + altitude + " km.";
				document.getElementById("result").innerHTML = info;

			  //return d;
			}

			function deg2rad(deg) {
			  return deg * (Math.PI/180)
			}

</script>

<!-- <script>

		var latitude = 39.881951;
		var longitude = 32.758416;
		// Initialize and add the map
		function initMap() {
		 // The location of Uluru
		 var uluru = {lat: latitude, lng: longitude};
		 // The map, centered at Uluru
		 var map = new google.maps.Map(
				 document.getElementById('mapid'), {zoom: 15, center: uluru});
		 // The marker, positioned at Uluru
		 var marker = new google.maps.Marker({position: uluru, map: map});
		}

		function showPosition() {
        if(navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                var positionInfo = "Your current position is (" + "Latitude: " + position.coords.latitude + ", " + "Longitude: " + position.coords.longitude + ")";
                document.getElementById("result").innerHTML = positionInfo;

								var uluru = {lat: position.coords.latitude, lng: position.coords.longitude};

								var map = new google.maps.Map(
							 		 document.getElementById('mapid'), {zoom: 15, center: uluru});
							  // The marker, positioned at Uluru
							  var marker = new google.maps.Marker({position: uluru, map: map});
								      marker.setPosition({
							         lat: position.coords.latitude,
							         lng: position.coords.longitude
							       });

							       // Center map to user's position.
							       map.panTo({
							         lat: position.coords.latitude,
							         lng: position.coords.longitude
							       });
            }
						//err => alert(`Error (${err.code}): ${getPositionErrorMessage(err.code)}`)
					);
        } else {
            alert("Sorry, your browser does not support HTML5 geolocation.");
        }
    }

		function showPositionbyCoordinates() {
			var lat = document.getElementsByName("lat")[0].value;
      var long = document.getElementsByName("long")[0].value;

        if(lat == null || long == null) {
                var positionInfo = "Your chosen position is (" + "Latitude: " + lat + ", " + "Longitude: " + long + ")";
                document.getElementById("result").innerHTML = positionInfo;

								var uluru = {lat: lat, lng: long};

								var map = new google.maps.Map(
							 		 document.getElementById('mapid'), {zoom: 15, center: uluru});
							  // The marker, positioned at Uluru
							  var marker = new google.maps.Marker({position: uluru, map: map});
								      marker.setPosition({
							         lat: lat,
							         lng: long
							       });

							       // Center map to user's position.
							       map.panTo({
							         lat: lat,
							         lng: long
							       });
						//err => alert(`Error (${err.code}): ${getPositionErrorMessage(err.code)}`)
					);
        } else {
            alert("Sorry, your browser does not support HTML5 geolocation.");
        }
    }

		const getPositionErrorMessage = code => {
		  switch (code) {
		    case 1:
		      return 'Permission denied.';
		    case 2:
		      return 'Position unavailable.';
		    case 3:
		      return 'Timeout reached.';
				}
		}
</script> -->

			 <!--Load the API -->
	<script async defer
			 src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCGEbAa_WjVH__x1X0LDo2HBGp7Yf-8rsE&callback=initMap">
	</script>

<!--===============================================================================================-->
	<script src="vendor/jquery/jquery-3.2.1.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/bootstrap/js/popper.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/select2/select2.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/daterangepicker/moment.min.js"></script>
	<script src="vendor/daterangepicker/daterangepicker.js"></script>
<!--===============================================================================================-->
	<script src="vendor/countdowntime/countdowntime.js"></script>
<!--===============================================================================================-->
	<script src="js/main.js"></script>

</body>
</html>
